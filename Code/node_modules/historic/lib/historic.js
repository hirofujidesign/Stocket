// Generated by CoffeeScript 1.6.2
(function() {
  var csv, http, splitDate;

  http = require('http');

  csv = require('csv');

  splitDate = function(date) {
    return [date.getMonth(), date.getDate(), date.getFullYear()];
  };

  module.exports = function(symbol, startDate, endDate, cb) {
    var a, b, c, d, e, f, url, _ref, _ref1, _ref2;

    _ref = [splitDate(startDate), splitDate(endDate)], (_ref1 = _ref[0], a = _ref1[0], b = _ref1[1], c = _ref1[2]), (_ref2 = _ref[1], d = _ref2[0], e = _ref2[1], f = _ref2[2]);
    url = "http://ichart.finance.yahoo.com/table.csv?s=" + symbol + "&a=" + a + "&b=" + b + "&c=" + c + "&d=" + d + "&e=" + e + "&f=" + f + "&g=d";
    return http.get(url, function(res) {
      if (res.statusCode === 200) {
        return csv().from(res, {
          columns: true
        }).to.array(function(data) {
          return cb(null, data);
        });
      } else {
        return cb(res.statusCode, null);
      }
    });
  };

}).call(this);
